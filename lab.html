<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Digital Twin Lab | StarOS Foundry</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&family=Rajdhani:wght@500;600;700;800&family=Noto+Sans+TC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['"Inter"', '"Noto Sans TC"', 'sans-serif'],
                        mono: ['"JetBrains Mono"', 'monospace'],
                        tech: ['"Rajdhani"', 'sans-serif'],
                    },
                    colors: {
                        star: { main: '#00FFA3', dark: '#050505', card: '#0F0F0F', border: '#222222', accent: '#6E00FF' }
                    },
                    backgroundImage: {
                        'grid-pattern': "linear-gradient(to right, #111 1px, transparent 1px), linear-gradient(to bottom, #111 1px, transparent 1px)",
                    },
                    animation: {
                        'scan': 'scan 3s linear infinite',
                        'pulse-fast': 'pulse 1.5s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    },
                    keyframes: {
                        scan: { '0%': { top: '0%' }, '50%': { top: '100%' }, '100%': { top: '0%' } }
                    }
                }
            }
        }
    </script>

    <style>
        body { background-color: #050505; color: #E0E0E0; overflow-x: hidden; }
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #000; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #00FFA3; }

        .glass { background: rgba(10, 10, 10, 0.9); backdrop-filter: blur(16px); border-bottom: 1px solid rgba(255, 255, 255, 0.08); }
        .glass-panel { background: rgba(15, 15, 15, 0.6); backdrop-filter: blur(10px); border: 1px solid #222; }
        
        /* Scan Line Effect */
        .scanner-container { position: relative; overflow: hidden; }
        .scan-line {
            position: absolute; left: 0; width: 100%; height: 2px;
            background: #00FFA3; box-shadow: 0 0 10px #00FFA3, 0 0 20px #00FFA3;
            animation: scan 3s linear infinite; z-index: 10; display: none;
        }
        .scan-overlay {
            position: absolute; inset: 0; 
            background: linear-gradient(180deg, rgba(0,255,163,0) 0%, rgba(0,255,163,0.1) 50%, rgba(0,255,163,0) 100%);
            animation: scan 3s linear infinite; display: none; pointer-events: none;
        }
        .scanning .scan-line, .scanning .scan-overlay { display: block; }

        /* Tech Borders */
        .tech-border { position: relative; }
        .tech-border::before { content: ''; position: absolute; top: -1px; left: -1px; width: 10px; height: 10px; border-top: 2px solid #00FFA3; border-left: 2px solid #00FFA3; }
        .tech-border::after { content: ''; position: absolute; bottom: -1px; right: -1px; width: 10px; height: 10px; border-bottom: 2px solid #00FFA3; border-right: 2px solid #00FFA3; }

        /* Progress Bar */
        .progress-segment { width: 20%; height: 100%; background: #111; border-right: 2px solid #000; transition: background 0.3s; }
        .progress-segment.active { background: #00FFA3; box-shadow: 0 0 10px rgba(0,255,163,0.5); }
    </style>
</head>

<body class="antialiased selection:bg-[#00FFA3] selection:text-black">

    <nav class="fixed w-full z-50 glass transition-all duration-300">
        <div class="max-w-[1920px] mx-auto px-4 md:px-8 h-16 flex justify-between items-center">
            <div class="flex items-center gap-3 cursor-pointer" onclick="window.location.href='index.html'">
                <div class="w-8 h-8 bg-white text-black flex items-center justify-center font-bold text-xl font-tech italic clip-path-polygon">S</div>
                <div class="leading-none">
                    <h1 class="font-bold text-lg tracking-tighter font-tech text-white">STAROS <span class="text-[#00FFA3] text-xs">FOUNDRY</span></h1>
                </div>
            </div>
            <div class="hidden md:flex gap-8 text-xs font-mono text-gray-500">
                <div class="flex items-center gap-2"><div class="w-1.5 h-1.5 bg-green-500 rounded-full"></div> <span>TEE ENCLAVE: SECURE</span></div>
                <div class="flex items-center gap-2"><div class="w-1.5 h-1.5 bg-green-500 rounded-full"></div> <span>GPU CLUSTER: READY</span></div>
            </div>
            <div class="flex items-center gap-4">
                <button onclick="app.toggleLang()" class="text-xs font-mono border border-[#333] px-3 py-1.5 rounded hover:border-[#00FFA3] text-white">
                    <span id="lang-display">繁體中文</span>
                </button>
                <div class="flex items-center gap-2 bg-[#111] border border-[#333] px-3 py-1.5 rounded text-xs font-mono">
                    <span class="text-[#00FFA3]">8xHt...9L2</span>
                </div>
            </div>
        </div>
    </nav>

    <main class="pt-24 pb-10 px-4 md:px-8 min-h-screen flex flex-col">
        
        <div class="flex justify-between items-end mb-8 max-w-[1800px] mx-auto w-full">
            <div>
                <h1 class="text-3xl md:text-5xl font-bold font-tech text-white uppercase mb-2">
                    <span data-i18n="title">Digital Twin</span> <span class="text-[#00FFA3]">Lab</span>
                </h1>
                <p class="text-gray-400 text-sm max-w-xl" data-i18n="subtitle">High-Fidelity 4D Scanning & TEE Encrypted Training Pipeline</p>
            </div>
            <div class="hidden md:block text-right">
                <div class="text-xs text-gray-500 uppercase mb-1" data-i18n="session_id">Session ID</div>
                <div class="font-mono text-[#00FFA3]">#TEE-8821-X9</div>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-6 max-w-[1800px] mx-auto w-full flex-1">
            
            <div class="lg:col-span-3 flex flex-col gap-6">
                <div class="glass-panel p-6 rounded-xl">
                    <h3 class="text-xs text-[#00FFA3] font-bold uppercase tracking-widest mb-4" data-i18n="data_type">1. Select Data Source</h3>
                    <div class="grid grid-cols-3 gap-2">
                        <button class="p-3 bg-[#111] border border-[#00FFA3] text-white rounded flex flex-col items-center gap-2 transition-all">
                            <i class="fa-solid fa-face-viewfinder text-xl"></i>
                            <span class="text-[10px] font-bold">FACE (4D)</span>
                        </button>
                        <button class="p-3 bg-[#111] border border-[#333] text-gray-500 hover:text-white rounded flex flex-col items-center gap-2 transition-all">
                            <i class="fa-solid fa-microphone-lines text-xl"></i>
                            <span class="text-[10px] font-bold">VOICE</span>
                        </button>
                        <button class="p-3 bg-[#111] border border-[#333] text-gray-500 hover:text-white rounded flex flex-col items-center gap-2 transition-all">
                            <i class="fa-solid fa-person-walking text-xl"></i>
                            <span class="text-[10px] font-bold">MOTION</span>
                        </button>
                    </div>
                </div>

                <div class="glass-panel p-6 rounded-xl flex-1 flex flex-col relative tech-border group" id="drop-zone">
                    <h3 class="text-xs text-[#00FFA3] font-bold uppercase tracking-widest mb-4" data-i18n="upload_title">2. Ingest Data</h3>
                    
                    <div class="flex-1 border-2 border-dashed border-[#333] rounded-lg bg-[#080808] flex flex-col items-center justify-center p-8 transition-colors group-hover:border-[#00FFA3]/50 cursor-pointer text-center" onclick="app.triggerUpload()">
                        <div class="w-16 h-16 rounded-full bg-[#111] flex items-center justify-center mb-4 group-hover:scale-110 transition-transform">
                            <i class="fa-solid fa-cloud-arrow-up text-2xl text-gray-400 group-hover:text-[#00FFA3]"></i>
                        </div>
                        <p class="text-sm text-white font-bold mb-1" data-i18n="drag_drop">Drag & Drop OBJ/FBX</p>
                        <p class="text-xs text-gray-600 mb-4">Max 50GB (Encrypted)</p>
                        <button class="px-4 py-2 bg-[#111] border border-[#333] text-xs text-white rounded hover:border-[#00FFA3]" data-i18n="browse">Browse Files</button>
                    </div>

                    <div id="file-list" class="hidden mt-4 space-y-2">
                        <div class="flex justify-between items-center p-2 bg-[#111] rounded border border-[#333] text-xs">
                            <span class="text-white"><i class="fa-solid fa-file-code text-[#00FFA3] mr-2"></i> scan_v1.obj</span>
                            <span class="text-gray-500">1.2GB</span>
                        </div>
                    </div>
                </div>

                <div class="glass-panel p-6 rounded-xl">
                    <h3 class="text-xs text-[#00FFA3] font-bold uppercase tracking-widest mb-4" data-i18n="meta_title">3. Asset Metadata</h3>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-[10px] text-gray-500 uppercase mb-1">Asset Name</label>
                            <input type="text" class="w-full bg-[#111] border border-[#333] text-white text-sm p-2 rounded focus:border-[#00FFA3] outline-none" value="Project Alpha_01">
                        </div>
                        <div>
                            <label class="block text-[10px] text-gray-500 uppercase mb-1">LoRA Trigger Word</label>
                            <input type="text" class="w-full bg-[#111] border border-[#333] text-white text-sm p-2 rounded focus:border-[#00FFA3] outline-none" value="sks_person">
                        </div>
                    </div>
                </div>
            </div>

            <div class="lg:col-span-6 relative">
                <div class="glass-panel h-full rounded-xl p-1 relative overflow-hidden flex flex-col tech-border scanner-container" id="scanner-view">
                    
                    <div class="absolute top-4 left-4 z-20 flex gap-4 text-[10px] font-mono">
                        <div class="bg-black/50 backdrop-blur px-2 py-1 rounded border border-white/10 text-white">POLY: <span class="text-[#00FFA3]" id="poly-count">0</span></div>
                        <div class="bg-black/50 backdrop-blur px-2 py-1 rounded border border-white/10 text-white">VERT: <span class="text-[#00FFA3]" id="vert-count">0</span></div>
                    </div>
                    <div class="absolute top-4 right-4 z-20">
                        <div class="flex items-center gap-2 bg-[#00FFA3]/10 px-3 py-1 rounded border border-[#00FFA3]/30">
                            <i class="fa-solid fa-shield-halved text-[#00FFA3] text-xs"></i>
                            <span class="text-[10px] font-bold text-[#00FFA3]">TEE SECURE</span>
                        </div>
                    </div>

                    <div class="flex-1 bg-[#020202] relative flex items-center justify-center overflow-hidden">
                        <div class="absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/graphy.png')] opacity-10"></div>
                        
                        <div class="relative z-10 w-64 h-80 opacity-30 transition-all duration-1000" id="model-placeholder">
                            <i class="fa-solid fa-user text-[200px] text-gray-700 absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2"></i>
                        </div>

                        <div class="scan-line"></div>
                        <div class="scan-overlay"></div>

                        <div id="status-overlay" class="absolute inset-0 flex items-center justify-center bg-black/80 z-30 hidden">
                            <div class="text-center">
                                <i class="fa-solid fa-circle-notch fa-spin text-4xl text-[#00FFA3] mb-4"></i>
                                <div class="text-white font-bold tracking-widest animate-pulse" id="status-text">INITIALIZING TEE...</div>
                            </div>
                        </div>
                    </div>

                    <div class="h-16 bg-[#0A0A0A] border-t border-[#222] flex items-center justify-between px-6">
                        <div class="flex gap-1 h-2 w-48">
                            <div class="progress-segment" id="seg-1"></div>
                            <div class="progress-segment" id="seg-2"></div>
                            <div class="progress-segment" id="seg-3"></div>
                            <div class="progress-segment" id="seg-4"></div>
                            <div class="progress-segment" id="seg-5"></div>
                        </div>
                        <button onclick="app.startProcessing()" id="btn-process" class="bg-[#00FFA3] hover:bg-white text-black px-6 py-2 font-bold font-mono text-xs uppercase rounded transition-colors flex items-center gap-2">
                            <i class="fa-solid fa-microchip"></i> <span data-i18n="btn_process">Start Processing</span>
                        </button>
                    </div>
                </div>
            </div>

            <div class="lg:col-span-3 flex flex-col gap-6">
                <div class="glass-panel p-0 rounded-xl flex-1 flex flex-col overflow-hidden">
                    <div class="bg-[#111] p-3 border-b border-[#222] flex justify-between items-center">
                        <span class="text-xs font-bold text-gray-400 uppercase"><i class="fa-solid fa-terminal mr-2"></i>System Log</span>
                        <div class="flex gap-1"><div class="w-2 h-2 rounded-full bg-red-500"></div><div class="w-2 h-2 rounded-full bg-yellow-500"></div><div class="w-2 h-2 rounded-full bg-green-500"></div></div>
                    </div>
                    <div class="flex-1 bg-black p-4 font-mono text-[10px] text-green-500/80 overflow-y-auto space-y-1" id="terminal-log">
                        <div class="text-gray-600">[SYSTEM] Connection established to StarOS Core.</div>
                        <div class="text-gray-600">[SYSTEM] Waiting for asset ingestion...</div>
                    </div>
                </div>

                <div class="glass-panel p-6 rounded-xl">
                    <h3 class="text-xs text-gray-400 font-bold uppercase tracking-widest mb-4" data-i18n="specs_title">Training Config</h3>
                    <div class="space-y-3 text-xs font-mono">
                        <div class="flex justify-between border-b border-[#222] pb-2">
                            <span class="text-gray-500">Base Model</span>
                            <span class="text-white">SDXL Turbo / Flux</span>
                        </div>
                        <div class="flex justify-between border-b border-[#222] pb-2">
                            <span class="text-gray-500">LoRA Rank</span>
                            <span class="text-[#00FFA3]">128 (High Res)</span>
                        </div>
                        <div class="flex justify-between border-b border-[#222] pb-2">
                            <span class="text-gray-500">Privacy</span>
                            <span class="text-[#00FFA3]">Intel SGX Enclave</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-500">Est. Time</span>
                            <span class="text-white">~25 Mins</span>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </main>

    <script>
        const TRANSLATIONS = {
            en: {
                title: "Digital Twin", subtitle: "High-Fidelity 4D Scanning & TEE Encrypted Training Pipeline",
                session_id: "Session ID", data_type: "1. Select Data Source", upload_title: "2. Ingest Data",
                drag_drop: "Drag & Drop OBJ/FBX", browse: "Browse Files", meta_title: "3. Asset Metadata",
                btn_process: "Start Processing", specs_title: "Training Config",
                log_1: "Analyzing mesh topology...", log_2: "Cleaning noise vertices...", log_3: "Rigging skeleton (Mixamo Standard)...", log_4: "Encrypting with TEE key...", log_5: "Upload to Arweave complete."
            },
            zh: {
                title: "數字孿生", subtitle: "高精度 4D 掃描與 TEE 加密訓練流水線",
                session_id: "會話 ID", data_type: "1. 選擇數據源", upload_title: "2. 數據採集",
                drag_drop: "拖拽上傳 OBJ/FBX", browse: "瀏覽文件", meta_title: "3. 資產元數據",
                btn_process: "開始處理", specs_title: "訓練配置參數",
                log_1: "正在分析網格拓撲...", log_2: "正在清洗噪聲頂點...", log_3: "正在綁定骨骼 (Mixamo 標準)...", log_4: "正在使用 TEE 私鑰加密...", log_5: "已上傳至 Arweave 存儲網絡。"
            }
        };

        let currentLang = 'en';

        const app = {
            toggleLang: function() {
                const btnText = document.getElementById('lang-display');
                currentLang = currentLang === 'en' ? 'zh' : 'en';
                btnText.innerText = currentLang === 'en' ? '繁體中文' : 'English';
                
                document.querySelectorAll('[data-i18n]').forEach(el => {
                    const key = el.getAttribute('data-i18n');
                    if (TRANSLATIONS[currentLang][key]) el.innerText = TRANSLATIONS[currentLang][key];
                });
            },

            triggerUpload: function() {
                // Simulating file selection
                document.getElementById('file-list').classList.remove('hidden');
                this.log("[UPLOAD] File 'scan_v1.obj' loaded. Size: 1.2GB");
                document.getElementById('model-placeholder').style.opacity = '1';
                document.getElementById('model-placeholder').innerHTML = '<i class="fa-solid fa-head-side-mask text-[200px] text-white"></i>';
            },

            startProcessing: function() {
                const btn = document.getElementById('btn-process');
                const scanner = document.getElementById('scanner-view');
                const overlay = document.getElementById('status-overlay');
                const text = document.getElementById('status-text');
                
                btn.disabled = true;
                btn.classList.add('opacity-50', 'cursor-not-allowed');
                scanner.classList.add('scanning');
                overlay.classList.remove('hidden');

                // Simulation Sequence
                let step = 0;
                const steps = currentLang === 'en' ? 
                    ["INITIALIZING TEE...", "MESH CLEANING...", "RIGGING...", "ENCRYPTING...", "MINTING SBT..."] :
                    ["初始化 TEE 環境...", "網格清洗中...", "骨骼綁定中...", "加密封裝中...", "鑄造 SBT..."];
                
                const logs = currentLang === 'en' ?
                    ["Allocating GPU memory...", "Geometry simplified to 50k polys.", "Auto-rigging successful.", "Private key generated inside enclave.", "Asset Hash: 0x8a...2b"] :
                    ["分配 GPU 顯存...", "幾何體簡化至 5萬面。", "自動綁定成功。", "私鑰已在安全區生成。", "資產哈希: 0x8a...2b"];

                const interval = setInterval(() => {
                    if (step >= 5) {
                        clearInterval(interval);
                        scanner.classList.remove('scanning');
                        overlay.classList.add('hidden');
                        btn.innerHTML = currentLang === 'en' ? '<i class="fa-solid fa-check"></i> COMPLETE' : '<i class="fa-solid fa-check"></i> 處理完成';
                        btn.classList.replace('bg-[#00FFA3]', 'bg-white');
                        this.updateCounter(120500, 120500); // Final Poly count
                    } else {
                        // Update UI
                        text.innerText = steps[step];
                        document.getElementById(`seg-${step+1}`).classList.add('active');
                        this.log(logs[step]);
                        
                        // Simulate counter
                        this.updateCounter(Math.floor(Math.random() * 50000), Math.floor(Math.random() * 30000));
                        
                        step++;
                    }
                }, 1500);
            },

            log: function(msg) {
                const div = document.getElementById('terminal-log');
                const time = new Date().toLocaleTimeString('en-US', {hour12:false});
                div.innerHTML += `<div><span class="text-gray-500">[${time}]</span> ${msg}</div>`;
                div.scrollTop = div.scrollHeight;
            },

            updateCounter: function(poly, vert) {
                document.getElementById('poly-count').innerText = poly.toLocaleString();
                document.getElementById('vert-count').innerText = vert.toLocaleString();
            }
        };
    </script>
</body>
</html>